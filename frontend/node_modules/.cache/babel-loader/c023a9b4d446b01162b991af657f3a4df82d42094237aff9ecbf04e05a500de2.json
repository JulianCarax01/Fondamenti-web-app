{"ast":null,"code":"import _slicedToArray from\"/home/mamba/WebstormProjects/app/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Message from\"./Message\";import{useEffect,useRef,useState}from\"react\";import{socket}from\"../socket\";import'../style/style_textcontainer.css';import{jsx as _jsx}from\"react/jsx-runtime\";export default function TextContainer(_ref){var rightChat=_ref.rightChat,loggedUser=_ref.loggedUser;var ref=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];var scroll=function scroll(){var _ref$current;var lastChild=(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.lastElementChild;lastChild===null||lastChild===void 0?void 0:lastChild.scrollIntoView();};useEffect(function(){socket.on(\"message\",function(_ref2){var text=_ref2.text,receiver=_ref2.receiver,sender=_ref2.sender;var p=document.createElement(\"p\");var background;var clas;loggedUser._id===sender._id?background=\"#f96d00\":background=\"#6643b5\";loggedUser._id===sender._id?clas=\"right\":clas=\"left\";p.style.background=background;p.style.marginLeft=\"auto\";p.style.width=\"fit-content\";p.className=clas;p.innerHTML=text;ref.current.append(p);/*const NewMex=<Message key={message._id}\n                                  message={message}\n                                  loggedUser={loggedUser}></Message>\n\n                                  chiedere ad Anas\n\n                                  */scroll();});},[]);useEffect(function(){scroll();});useEffect(function(){var Chats=rightChat.messages.map(function(message){return/*#__PURE__*/_jsx(Message,{message:message,loggedUser:loggedUser},message._id);});setChats(Chats);scroll();},[rightChat]);return/*#__PURE__*/_jsx(\"div\",{className:'chatdiv',ref:ref,children:chats});}/*useEffect(() => {\n        socket.on(\"message\", ({text, receiver, sender}) => {\n            let p = document.createElement(\"p\")\n            let background;\n            let clas;\n            loggedUser._id === sender._id ? background = `#f96d00` : background = `#6643b5`\n            loggedUser._id === sender._id ? clas = `right` : clas = `left`\n            p.style.background = background;\n            p.style.marginLeft = \"auto\";\n            p.style.width = \"fit-content\";\n            p.className = clas;\n            p.innerHTML = text;\n            ref.current.append(p)\n            scroll()\n        },[])\n    });*/","map":{"version":3,"names":["Message","useEffect","useRef","useState","socket","jsx","_jsx","TextContainer","_ref","rightChat","loggedUser","ref","_useState","_useState2","_slicedToArray","chats","setChats","scroll","_ref$current","lastChild","current","lastElementChild","scrollIntoView","on","_ref2","text","receiver","sender","p","document","createElement","background","clas","_id","style","marginLeft","width","className","innerHTML","append","Chats","messages","map","message","children"],"sources":["/home/mamba/WebstormProjects/app/frontend/src/components/TextContainer.jsx"],"sourcesContent":["import Message from \"./Message\";\nimport {useEffect, useRef, useState} from \"react\";\nimport {socket} from \"../socket\";\nimport '../style/style_textcontainer.css'\n\nexport default function TextContainer({rightChat, loggedUser}) {\n    const ref = useRef(null)\n    const [chats, setChats] = useState([])\n\n    const scroll = () => {\n        const lastChild = ref.current?.lastElementChild;\n        lastChild?.scrollIntoView()\n    }\n\n    useEffect(() => {\n        socket.on(\"message\", ({text, receiver, sender}) => {\n            let p = document.createElement(\"p\")\n            let background;\n            let clas;\n            loggedUser._id === sender._id ? background = `#f96d00` : background = `#6643b5`\n            loggedUser._id === sender._id ? clas = `right` : clas = `left`\n            p.style.background = background;\n            p.style.marginLeft = \"auto\";\n            p.style.width = \"fit-content\";\n            p.className = clas;\n            p.innerHTML = text;\n            ref.current.append(p)\n\n            /*const NewMex=<Message key={message._id}\n                                  message={message}\n                                  loggedUser={loggedUser}></Message>\n\n                                  chiedere ad Anas\n\n                                  */\n\n            scroll()\n        })\n    },[]);\n\n    useEffect(()=>{\n        scroll()\n    })\n\n    useEffect(() => {\n        const Chats = rightChat.messages.map((message) => {\n            return <Message key={message._id}\n                            message={message}\n                            loggedUser={loggedUser}></Message>\n        })\n        setChats(Chats)\n        scroll()\n    }, [rightChat])\n\n    return (\n        <div className={'chatdiv'} ref={ref}>\n            {chats}\n        </div>\n\n\n    )\n}\n\n\n/*useEffect(() => {\n        socket.on(\"message\", ({text, receiver, sender}) => {\n            let p = document.createElement(\"p\")\n            let background;\n            let clas;\n            loggedUser._id === sender._id ? background = `#f96d00` : background = `#6643b5`\n            loggedUser._id === sender._id ? clas = `right` : clas = `left`\n            p.style.background = background;\n            p.style.marginLeft = \"auto\";\n            p.style.width = \"fit-content\";\n            p.className = clas;\n            p.innerHTML = text;\n            ref.current.append(p)\n            scroll()\n        },[])\n    });*/\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}