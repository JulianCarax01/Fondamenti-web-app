{"ast":null,"code":"import _slicedToArray from\"/home/mamba/WebstormProjects/app/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import ChatButton from\"../components/ChatButton\";import Chat from\"../components/Chat\";import'../style/style_viewfriends.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ChatsPageFriends(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friendList=_useState2[0],setFriendList=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedFriend=_useState4[0],setSelectedFriend=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),chats=_useState10[0],setChats=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showChatRoom=_useState12[0],setShowChatRoom=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),rightChat=_useState14[0],setRightChat=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),otherUser=_useState16[0],setOtherUser=_useState16[1];var loggedUser=JSON.parse(localStorage.getItem(\"user\"));useEffect(function(){//con questa prima axios otteniamo la lista degli amici \naxios.get(\"http://localhost:3000/api/users/viewFriends/\"+\"\".concat(loggedUser._id)).then(function(res){if(res.data&&res.data.friends){setFriendList(res.data.friends);}}).catch(function(error){if(error.response&&error.response.status===401){alert(\"Utente non trovato\");}else{console.error(error);}});},[]);//con questa otteniamo le chat dell'utente attualmente loggato \nuseEffect(function(){axios.get(\"http://localhost:3000/api/users/showChat/\"+\"\".concat(loggedUser._id)).then(function(res){if(res.status===200){return res.data;}else{throw new Error(\"Errore di comunicazione col server nell'ottenimento delle chat\");}}).then(function(dati){setLoading(false);setChats(dati);}).catch(function(e){setError(true);setLoading(false);console.log(e);});},[]);//quando selezioniamo un amico otteniamo la sua chat corrispondente tramite il setRightChat e la visualizzo\nvar handleFriendSelection=function handleFriendSelection(friend){setSelectedFriend(friend);setRightChat(chats.find(function(chat){return chat.utente1===friend._id||chat.utente2===friend._id;}));setOtherUser(friend.username);setShowChatRoom(true);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"In questa pagina puoi visualizzare le chat con i tuoi amici\"}),(friendList===null||friendList===void 0?void 0:friendList.length)===0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Non sono presenti amici nella lista\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Se vuoi aggiungerli\"}),/*#__PURE__*/_jsxs(\"a\",{href:\"http://localhost:3001/addFriend\",children:[\" \",/*#__PURE__*/_jsx(\"button\",{children:\"Aggiungi amico\"}),\" \"]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:\"friend-list\",children:friendList.map(function(friend){return/*#__PURE__*/_jsxs(\"li\",{className:\"friend-list-item\",onClick:function onClick(){return handleFriendSelection(friend);},children:[\" \",friend.username]},friend._id);})}),selectedFriend&&showChatRoom&&/*#__PURE__*/_jsx(Chat,{rightChat:rightChat,otherUser:otherUser,loggedUser:loggedUser})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\" Per ritornare alla \",/*#__PURE__*/_jsx(\"a\",{href:\"http://localhost:3001/homepage\",style:{color:\"#6643b5\"},children:\" Homepage \"}),\" \"]})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","ChatButton","Chat","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChatsPageFriends","_useState","_useState2","_slicedToArray","friendList","setFriendList","_useState3","_useState4","selectedFriend","setSelectedFriend","_useState5","_useState6","loading","setLoading","_useState7","_useState8","error","setError","_useState9","_useState10","chats","setChats","_useState11","_useState12","showChatRoom","setShowChatRoom","_useState13","_useState14","rightChat","setRightChat","_useState15","_useState16","otherUser","setOtherUser","loggedUser","JSON","parse","localStorage","getItem","get","concat","_id","then","res","data","friends","catch","response","status","alert","console","Error","dati","e","log","handleFriendSelection","friend","find","chat","utente1","utente2","username","children","length","href","className","map","onClick","style","color"],"sources":["/home/mamba/WebstormProjects/app/frontend/src/pages/ChatsPageFriends.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport axios from \"axios\"\nimport ChatButton from \"../components/ChatButton\";\nimport Chat from \"../components/Chat\"\nimport '../style/style_viewfriends.css'\n\nexport default function ChatsPageFriends() {\n  const [friendList, setFriendList] = useState([])\n  const [selectedFriend, setSelectedFriend] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(false)\n  const [chats, setChats] = useState([]);\n  const [showChatRoom, setShowChatRoom] = useState(false)\n  const [rightChat, setRightChat] = useState({})\n  const [otherUser, setOtherUser] = useState(\"\")\n  const loggedUser = JSON.parse(localStorage.getItem(\"user\"))\n\n  useEffect(() => {\n      //con questa prima axios otteniamo la lista degli amici \n      axios.get(\"http://localhost:3000/api/users/viewFriends/\" + `${loggedUser._id}`)\n      .then(res => {\n        if (res.data && res.data.friends) {\n          setFriendList(res.data.friends)\n        } })\n      .catch((error) => {\n        if (error.response && error.response.status === 401) {\n          alert(\"Utente non trovato\")\n        } else {\n          console.error(error)\n        } })\n  }, []);\n\n  //con questa otteniamo le chat dell'utente attualmente loggato \n\n  useEffect(() => {\n    axios.get(`http://localhost:3000/api/users/showChat/` + `${loggedUser._id}`)\n      .then((res) => {\n        if (res.status === 200) {\n          return res.data;\n        } else {\n          throw new Error(\"Errore di comunicazione col server nell'ottenimento delle chat\");\n        }\n      })\n      .then((dati) => {\n        setLoading(false);\n        setChats(dati)\n      })\n      .catch((e) => {\n        setError(true);\n        setLoading(false);\n        console.log(e)\n      });\n  }, []);\n\n  //quando selezioniamo un amico otteniamo la sua chat corrispondente tramite il setRightChat e la visualizzo\n\n  const handleFriendSelection = (friend) => {\n    setSelectedFriend(friend)\n    setRightChat(chats.find(chat => chat.utente1 === friend._id || chat.utente2 === friend._id))\n    setOtherUser(friend.username)\n    setShowChatRoom(true)\n  };\n\n\n  return (\n    <div>\n      <h2>In questa pagina puoi visualizzare le chat con i tuoi amici</h2>\n      {friendList?.length === 0 ? (\n        <>\n          <p>Non sono presenti amici nella lista</p>\n          <p>Se vuoi aggiungerli</p>\n          <a href=\"http://localhost:3001/addFriend\"> <button>Aggiungi amico</button> </a>\n        </>\n      ) : (\n        <>\n          <ul className=\"friend-list\">\n            {friendList.map((friend) => (\n              <li className=\"friend-list-item\" key={friend._id} onClick={() => handleFriendSelection(friend)} > {friend.username}\n              </li>\n            ))}\n          </ul>\n          {selectedFriend && showChatRoom && (\n    <Chat rightChat={rightChat}  otherUser={otherUser} loggedUser={loggedUser}/> )}</>\n      )}\n      <p> Per ritornare alla <a href=\"http://localhost:3001/homepage\" style={{ color: \"#6643b5\" }}> Homepage </a> </p>\n\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}